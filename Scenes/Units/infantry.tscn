[gd_scene load_steps=53 format=3 uid="uid://dli7arg3vprq4"]

[ext_resource type="Script" uid="uid://cms6k1uocuuv2" path="res://Scripts/Units/Units/Infantry.cs" id="1_2fp7d"]
[ext_resource type="Texture2D" uid="uid://coca1wutprsho" path="res://Assets/Textures/SelectBorder.png" id="2_mhdsq"]
[ext_resource type="PackedScene" uid="uid://chptg2e33u5s4" path="res://Scenes/Shared/healthbar.tscn" id="4_r0f05"]
[ext_resource type="AudioStream" uid="uid://bbwury3qlup3w" path="res://Assets/Audio/MachineGun.wav" id="5_8tceu"]
[ext_resource type="AudioStream" uid="uid://co77t3mud6al4" path="res://Assets/Audio/ImpactWithMetal.wav" id="7_3d2wm"]
[ext_resource type="AudioStream" uid="uid://c16bgi1py2kfw" path="res://Assets/Audio/ExplosionWithMetal.wav" id="8_t7228"]
[ext_resource type="Script" uid="uid://wanphedcs3sa" path="res://Scripts/Units/LODManager.cs" id="9_sfiqi"]
[ext_resource type="Script" uid="uid://dlbb13mgp6kq1" path="res://Scripts/Units/CombatSystem.cs" id="10_gl3ar"]
[ext_resource type="Script" uid="uid://bhmxuey5m0ru8" path="res://Scripts/Units/HealthSystem.cs" id="11_jnobf"]
[ext_resource type="Script" uid="uid://h6bdsqjhlaxl" path="res://Scripts/Units/WeaponSystem.cs" id="12_7qmmn"]
[ext_resource type="PackedScene" uid="uid://ell248v16ses" path="res://Scenes/VFX/explosion.tscn" id="13_7topc"]
[ext_resource type="Texture2D" uid="uid://djsa3anxcvbst" path="res://Assets/Textures/MuzzleFlash/MuzzleFlash.png" id="14_len2g"]
[ext_resource type="ArrayMesh" uid="uid://gv6m7q3rqdu5" path="res://Assets/VFX/MuzzlePlane.obj" id="15_fnrf3"]
[ext_resource type="Texture2D" uid="uid://brscwxgt8w15i" path="res://Assets/Textures/MuzzleFlash/MuzzleFlashCone.png" id="16_l0e8h"]
[ext_resource type="ArrayMesh" uid="uid://dxut7hkb8p4cl" path="res://Assets/VFX/MuzzleCone.obj" id="17_6ud4c"]
[ext_resource type="PackedScene" uid="uid://wrtccqu5n2tm" path="res://Scenes/Units/LOD/Infantry/infantry_lp.tscn" id="18_8tceu"]
[ext_resource type="Texture2D" uid="uid://xncrdbwk0mde" path="res://Assets/Textures/MuzzleFlash/MuzzleFlashBeam.png" id="18_enyns"]
[ext_resource type="Shader" uid="uid://0llt3gcj2lyb" path="res://Shaders/impact_smoke.tres" id="19_ph7o2"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_ebj34"]
height = 1.91406
radius = 0.385

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_bkhit"]
playback_mode = 1
random_pitch = 1.75
random_volume_offset_db = 0.5
streams_count = 1
stream_0/stream = ExtResource("5_8tceu")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_0fnl8"]
random_pitch = 1.5
random_volume_offset_db = 0.8
streams_count = 1
stream_0/stream = ExtResource("7_3d2wm")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_r0f05"]
streams_count = 1
stream_0/stream = ExtResource("8_t7228")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_8tceu"]
render_priority = 1
transparency = 1
blend_mode = 1
cull_mode = 2
shading_mode = 0
vertex_color_use_as_albedo = true
vertex_color_is_srgb = true
albedo_texture = ExtResource("14_len2g")

[sub_resource type="Curve" id="Curve_bkhit"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_y4stx"]
curve = SubResource("Curve_bkhit")

[sub_resource type="Curve" id="Curve_0fnl8"]
_data = [Vector2(0, 0), 0.0, 3.20406, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_pjyd2"]
curve = SubResource("Curve_0fnl8")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_r0f05"]
gravity = Vector3(0, 0, 0)
scale_min = 0.5
scale_max = 0.75
scale_curve = SubResource("CurveTexture_pjyd2")
color = Color(2, 1.5, 1, 1)
alpha_curve = SubResource("CurveTexture_y4stx")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7kmu1"]
render_priority = 1
transparency = 1
blend_mode = 1
cull_mode = 2
shading_mode = 0
vertex_color_use_as_albedo = true
vertex_color_is_srgb = true
albedo_texture = ExtResource("16_l0e8h")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_wwehk"]
transparency = 1
blend_mode = 1
cull_mode = 2
shading_mode = 0
vertex_color_use_as_albedo = true
vertex_color_is_srgb = true
albedo_texture = ExtResource("18_enyns")
billboard_mode = 3
billboard_keep_scale = true
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="Curve" id="Curve_3d2wm"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_g1ow1"]
curve = SubResource("Curve_3d2wm")

[sub_resource type="Curve" id="Curve_t7228"]
_data = [Vector2(0, 0), 0.0, 3.20406, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_6rfje"]
curve = SubResource("Curve_t7228")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_sfiqi"]
gravity = Vector3(0, 0, 0)
scale_min = 0.6
scale_max = 0.6
scale_curve = SubResource("CurveTexture_6rfje")
color = Color(1.5, 1, 0.5, 1)
alpha_curve = SubResource("CurveTexture_g1ow1")

[sub_resource type="QuadMesh" id="QuadMesh_gl3ar"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_jnobf"]
render_priority = 1
transparency = 1
blend_mode = 1
cull_mode = 2
vertex_color_use_as_albedo = true
vertex_color_is_srgb = true
albedo_texture = ExtResource("18_enyns")

[sub_resource type="Curve" id="Curve_7qmmn"]
_data = [Vector2(0.00512821, 0.987116), 0.0, -2.96919, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_2aiw2"]
curve = SubResource("Curve_7qmmn")

[sub_resource type="Curve" id="Curve_7topc"]
_limits = [0.0, 100.0, 0.0, 1.0]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.992308, 100), 294.556, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_ohh4q"]
curve = SubResource("Curve_7topc")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_len2g"]
particle_flag_align_y = true
emission_shape = 1
emission_sphere_radius = 0.6
direction = Vector3(0, 0, 1)
spread = 50.0
initial_velocity_min = 5.0
initial_velocity_max = 30.0
gravity = Vector3(0, 0, 0)
damping_min = 0.5
damping_max = 0.8
damping_curve = SubResource("CurveTexture_ohh4q")
scale_min = 0.05
scale_max = 0.3
color = Color(5, 3, 1, 1)
alpha_curve = SubResource("CurveTexture_2aiw2")

[sub_resource type="QuadMesh" id="QuadMesh_fnrf3"]
size = Vector2(0.15, 0.5)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_l0e8h"]
render_priority = 1
shader = ExtResource("19_ph7o2")
shader_parameter/DistanceFade = 0.3

[sub_resource type="Curve" id="Curve_6ud4c"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.489362, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_fm6nx"]
curve = SubResource("Curve_6ud4c")

[sub_resource type="Gradient" id="Gradient_enyns"]
colors = PackedColorArray(0, 0, 0, 1, 0.0177324, 0.0177324, 0.0177324, 0.619)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_r41al"]
gradient = SubResource("Gradient_enyns")
use_hdr = true

[sub_resource type="Curve" id="Curve_ph7o2"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0.325843), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_ewpmt"]
curve = SubResource("Curve_ph7o2")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_pmrmu"]
emission_shape = 6
emission_ring_axis = Vector3(0, 0, 1)
emission_ring_height = 0.0
emission_ring_radius = 1.0
emission_ring_inner_radius = 1.0
emission_ring_cone_angle = 90.0
angle_min = -180.0
angle_max = 180.0
direction = Vector3(1, 1, 0)
radial_velocity_min = 0.499978
radial_velocity_max = 0.499978
gravity = Vector3(0, 0, 0)
scale_min = 0.5
scale_max = 0.75
scale_curve = SubResource("CurveTexture_ewpmt")
color_ramp = SubResource("GradientTexture1D_r41al")
alpha_curve = SubResource("CurveTexture_fm6nx")

[sub_resource type="SphereMesh" id="SphereMesh_cc0cs"]

[node name="Infantry" type="CharacterBody3D" node_paths=PackedStringArray("Death", "PrimaryWeaponSystem", "LODManager", "_healthSystem") groups=["damageable", "units"]]
script = ExtResource("1_2fp7d")
InfantryType = 1
Speed = 4
HP = 100
Cost = 100
BuildTime = 4
Acceleration = 4
Death = NodePath("Death")
MiniMapRadius = 2.0
_rotationSpeed = 2000.0
PrimaryWeaponSystem = NodePath("Systems/WeaponSystemPrimary")
LODManager = NodePath("Systems/LODManager")
_healthSystem = NodePath("Systems/HealthSystem")
metadata/_edit_group_ = true

[node name="Model" parent="." instance=ExtResource("18_8tceu")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1.1, 0, 0, 0, 1.1, 0, 0, 0, 1.1, 1.02692e-08, 1.22405, -0.00991298)
shape = SubResource("CylinderShape3D_ebj34")

[node name="SelectBorder" type="Sprite3D" parent="."]
transform = Transform3D(0.719, 0, 0, 0, 0.924, 0, 0, 0, 0.609, 0, 1.14778, 0)
billboard = 1
no_depth_test = true
render_priority = 1
texture = ExtResource("2_mhdsq")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
avoidance_enabled = true

[node name="Healthbar" parent="." instance=ExtResource("4_r0f05")]
transform = Transform3D(0.441, 0, 0, 0, 0.505, 0, 0, 0, 0.505, 0, 2.87438, 0)

[node name="Audio" type="Node3D" parent="."]

[node name="Attack" type="AudioStreamPlayer3D" parent="Audio"]
stream = SubResource("AudioStreamRandomizer_bkhit")
volume_db = -5.0
unit_size = 35.0

[node name="Impact" type="AudioStreamPlayer3D" parent="Audio"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 0, 0, 0)
stream = SubResource("AudioStreamRandomizer_0fnl8")
volume_db = 2.0

[node name="Death" type="AudioStreamPlayer3D" parent="Audio"]
stream = SubResource("AudioStreamRandomizer_r0f05")
volume_db = 8.5

[node name="Systems" type="Node" parent="."]

[node name="LODManager" type="Node" parent="Systems"]
script = ExtResource("9_sfiqi")
_lodNear = 100.0
_highId = 7
_lowId = 7
PrimaryTurretPath = NodePath("../../Model")
PrimaryMuzzleContainerPath = NodePath("../../Model/rig/Skeleton3D/Rifle/Rifle")

[node name="CombatSystemPrimary" type="Node" parent="Systems" node_paths=PackedStringArray("_unit", "_weaponSystem", "_muzzleFlashParticles", "_attackSound")]
script = ExtResource("10_gl3ar")
_unit = NodePath("../..")
_weaponSystem = NodePath("../WeaponSystemPrimary")
_turnSpeedDeg = 2000.0
_muzzleFlashParticles = NodePath("../../MuzzleFlash")
_attackSound = NodePath("../../Audio/Attack")

[node name="HealthSystem" type="Node" parent="Systems" node_paths=PackedStringArray("_unit")]
script = ExtResource("11_jnobf")
_unit = NodePath("../..")

[node name="WeaponSystemPrimary" type="Node" parent="Systems"]
script = ExtResource("12_7qmmn")
Dmg = 1
Range = 20
FireRate = 0.1
ProjectileSpeed = 150.0
BulletSpread = 0.5
WeaponType = 2
ProjectileScale = Vector3(0.3, 0.3, 0.3)

[node name="Death" parent="." instance=ExtResource("13_7topc")]

[node name="MuzzleFlash" type="Node3D" parent="."]
transform = Transform3D(19.2274, 19.2274, 0, -19.2274, 19.2274, 0, 0, 0, 12.0584, 0.0138766, 4.37099, -0.227879)

[node name="MuzzlePlanes" type="GPUParticles3D" parent="MuzzleFlash"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
material_override = SubResource("StandardMaterial3D_8tceu")
emitting = false
amount = 1
lifetime = 0.1
one_shot = true
randomness = 1.0
process_material = SubResource("ParticleProcessMaterial_r0f05")
draw_pass_1 = ExtResource("15_fnrf3")

[node name="MuzzleCone" type="GPUParticles3D" parent="MuzzleFlash"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
visible = false
material_override = SubResource("StandardMaterial3D_7kmu1")
emitting = false
amount = 1
lifetime = 0.1
one_shot = true
randomness = 1.0
process_material = SubResource("ParticleProcessMaterial_r0f05")
draw_pass_1 = ExtResource("17_6ud4c")

[node name="BeamFlash" type="GPUParticles3D" parent="MuzzleFlash"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
material_override = SubResource("StandardMaterial3D_wwehk")
emitting = false
amount = 1
lifetime = 0.1
one_shot = true
randomness = 1.0
process_material = SubResource("ParticleProcessMaterial_sfiqi")
draw_pass_1 = SubResource("QuadMesh_gl3ar")

[node name="Sparks" type="GPUParticles3D" parent="MuzzleFlash"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
visible = false
material_override = SubResource("StandardMaterial3D_jnobf")
emitting = false
amount = 20
lifetime = 0.2
one_shot = true
explosiveness = 0.7
randomness = 1.0
process_material = SubResource("ParticleProcessMaterial_len2g")
draw_pass_1 = SubResource("QuadMesh_fnrf3")

[node name="Smoke" type="GPUParticles3D" parent="MuzzleFlash"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
visible = false
material_override = SubResource("ShaderMaterial_l0e8h")
cast_shadow = 0
emitting = false
amount = 12
one_shot = true
explosiveness = 0.85
process_material = SubResource("ParticleProcessMaterial_pmrmu")
draw_pass_1 = SubResource("SphereMesh_cc0cs")

[editable path="Model"]
